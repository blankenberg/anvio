<tool id="anvi_run_ncbi_cogs" name="anvi-run-ncbi-cogs" version="5.3.0" tool_type="default">
    <description>Run NCBI COGs on stuff.</description>
    <requirements>
        <requirement type="package" version="5.3.0">anvio</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <version_command>anvi-run-ncbi-cogs --version</version_command>
    <command><![CDATA[
        cp -R '${input_contigs_db.extra_files_path}' '${output_contigs_db.extra_files_path}'
 && 

    #if $input_cog_data_dir:
        cp -R '${input_cog_data_dir.extra_files_path}' '${output_cog_data_dir.extra_files_path}'
    #else
        echo ''
    #end if
 &&
 anvi-run-ncbi-cogs
--contigs-db '${output_contigs_db.extra_files_path}/CONTIGS.db'

--cog-data-dir '${output_cog_data_dir.extra_files_path}'

--num-threads "\${GALAXY_SLOTS:-1}"

${sensitive}


#if $str( $search_with ):
    --search-with '${search_with}'
#end if

&> '${GALAXY_ANVIO_LOG}'

    ]]></command>
    <inputs>
        <param name="input_contigs_db" type="data" label="Contigs Db" format="anvio_contigs_db" optional="False" multiple="False" argument="--contigs-db" help="Anvi'o contigs database generated by 'anvi-gen-contigs'"/>
        <param name="input_cog_data_dir" type="data" label="Cog Data Dir" format="anvio_cog_profile" optional="True" multiple="False" argument="--cog-data-dir" help="The directory path for your COG setup. Anvi'o will try to use the default path if you do not specify anything."/>
        <param name="sensitive" type="boolean" label="Sensitive" truevalue="--sensitive" falsevalue="" checked="False" optional="True" argument="--sensitive" help="DIAMOND sensitivity. With this flag you can instruct DIAMOND to be 'sensitive', rather than 'fast' during the search. It is likely the search will take remarkably longer. But, hey, if you are doing it for your final analysis, maybe it should take longer and be more accurate. This flag is only relevant if you are running DIAMOND."/>
        <param name="search_with" type="text" label="Search With" value="diamond" optional="True" argument="--search-with" help="What program to use for database searching. The default search uses diamond. All available options include: diamond, blastp."/>
    </inputs>
    <outputs>
        <data name="output_contigs_db" format="anvio_contigs_db" format_source="input_contigs_db" metadata_source="input_contigs_db" label="${tool.name} on ${on_string}: Contigs Db"/>
        <data name="output_cog_data_dir" format="anvio_cog_profile" format_source="input_cog_data_dir" metadata_source="input_cog_data_dir" label="${tool.name} on ${on_string}: Cog Data Dir"/>
        <data name="GALAXY_ANVIO_LOG" format="txt" label="${tool.name} on ${on_string}: Log"/>
    </outputs>
    <help><![CDATA[
        usage: anvi-run-ncbi-cogs [-h] -c CONTIGS_DB [--cog-data-dir COG_DATA_DIR]
                              [-T NUM_THREADS] [--sensitive]
                              [--temporary-dir-path PATH]
                              [--search-with SEARCH_METHOD]

Run NCBI COGs on stuff.

optional arguments:
  -h, --help            show this help message and exit
  -c CONTIGS_DB, --contigs-db CONTIGS_DB
                        Anvi'o contigs database generated by 'anvi-gen-
                        contigs'
  --cog-data-dir COG_DATA_DIR
                        The directory path for your COG setup. Anvi'o will try
                        to use the default path if you do not specify
                        anything.
  -T NUM_THREADS, --num-threads NUM_THREADS
                        Maximum number of threads to use for multithreading
                        whenever possible. Very conservatively, the default is
                        1. It is a good idea to not exceed the number of CPUs
                        / cores on your system. Plus, please be careful with
                        this option if you are running your commands on a SGE
                        --if you are clusterizing your runs, and asking for
                        multiple threads to use, you may deplete your
                        resources very fast.
  --sensitive           DIAMOND sensitivity. With this flag you can instruct
                        DIAMOND to be 'sensitive', rather than 'fast' during
                        the search. It is likely the search will take
                        remarkably longer. But, hey, if you are doing it for
                        your final analysis, maybe it should take longer and
                        be more accurate. This flag is only relevant if you
                        are running DIAMOND.
  --temporary-dir-path PATH
                        If you don't provide anything here, this program will
                        come up with a temporary directory path by itself to
                        store intermediate files, and clean it later. If you
                        want to have full control over this, you can use this
                        flag to define one..
  --search-with SEARCH_METHOD
                        What program to use for database searching. The
                        default search uses diamond. All available options
                        include: diamond, blastp.

    ]]></help>
    <citations>
        <citation type="doi">10.7717/peerj.1319</citation>
        <citation type="bibtex">@ARTICLE{Blankenberg19-anvio,
   author = {Daniel Blankenberg, et al},
   title = {In preparation..},
   }</citation>
    </citations>
</tool>