<tool id="anvi_update_genes_in_structure_database" name="anvi-update-genes-in-structure-database" version="5.3">
    <description>Add or remove genes from an already existing                                                   structure database. All settings used to generate                                                   your database will be used in this program.</description>
    <requirements>
        <requirement type="package" version="5.3">anvio</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <version_command>anvi-update-genes-in-structure-database --version</version_command>
    <command><![CDATA[
        cp -R '${input_contigs_db.extra_files_path}' '${output_contigs_db.extra_files_path}'
 && 
cp -R '${input_structure_db.extra_files_path}' '${output_structure_db.extra_files_path}'
 &&
 anvi-update-genes-in-structure-database
--contigs-db '${output_contigs_db.extra_files_path}/CONTIGS.db'


#if $output_structure_db:
    --structure-db '${output_structure_db.extra_files_path}/${output_structure_db.metadata.anvio_basename}'
#end if


#if $str( $genes_to_remove ):
    --genes-to-remove '${genes_to_remove}'
#end if


#if $str( $genes_to_remove_file ):
    --genes-to-remove-file '${genes_to_remove_file}'
#end if


#if $str( $genes_to_add ):
    --genes-to-add '${genes_to_add}'
#end if


#if $str( $genes_to_add_file ):
    --genes-to-add-file '${genes_to_add_file}'
#end if


#if $dump_dir:
    --dump-dir '${dump_dir.extra_files_path}'
#end if

${skip_genes_if_already_present}

&> '${GALAXY_ANVIO_LOG}'

    ]]></command>
    <inputs>
        <param name="input_contigs_db" type="data" label="Contigs Db" format="anvio_contigs_db" optional="False" multiple="False" argument="--contigs-db" help="Anvi'o contigs database generated by 'anvi-gen-contigs'"/>
        <param name="input_structure_db" type="data" label="Structure Db" format="anvio_structure_db" optional="False" multiple="False" argument="--structure-db" help="Anvi'o structure database."/>
        <param name="genes_to_remove" type="text" label="Genes To Remove" value="" optional="True" argument="--genes-to-remove" help="Gene caller ids to remove from your structure database. Multiple of them can be declared by separating with comma (e.g. --genes-to-remove 2,4,5,6)."/>
        <param name="genes_to_remove_file" type="text" label="Genes To Remove File" value="" optional="True" argument="--genes-to-remove-file" help="A file of gene caller ids to remove from your structure database. Each line in the file should be a gene caller id."/>
        <param name="genes_to_add" type="text" label="Genes To Add" value="" optional="True" argument="--genes-to-add" help="Gene caller ids to remove from your structure database. Multiple of them can be declared by separating with comma (e.g. --genes-to-add 2,4,5,6)."/>
        <param name="genes_to_add_file" type="text" label="Genes To Add File" value="" optional="True" argument="--genes-to-add-file" help="A file of gene caller ids to remove from your structure database. Each line in the file should be a gene caller id."/>
        <param name="skip_genes_if_already_present" type="boolean" label="Skip Genes If Already Present" truevalue="--skip-genes-if-already-present" falsevalue="" checked="" optional="True" argument="--skip-genes-if-already-present" help="If you try to add a gene that is already present, instead of complaining it will be skipped."/>
    </inputs>
    <outputs>
        <data name="output_contigs_db" format="anvio_contigs_db" format_source="input_contigs_db" metadata_source="input_contigs_db" label="${tool.name} on ${on_string}: Contigs Db"/>
        <data name="output_structure_db" format="anvio_structure_db" format_source="input_structure_db" metadata_source="input_structure_db" label="${tool.name} on ${on_string}: Structure Db"/>
        <data name="dump_dir" format="anvio_composite" format_source="input_dump_dir" metadata_source="input_dump_dir" label="${tool.name} on ${on_string}: Dump Dir"/>
        <data name="GALAXY_ANVIO_LOG" format="txt" label="${tool.name} on ${on_string}: Log"/>
    </outputs>
    <help><![CDATA[
        usage: anvi-update-genes-in-structure-database [-h] -c CONTIGS_DB -s STRUCTURE_DB
                              [--genes-to-remove GENES_TO_REMOVE]
                              [--genes-to-remove-file GENES_TO_REMOVE_FILE]
                              [--genes-to-add GENES_TO_ADD]
                              [--genes-to-add-file GENES_TO_ADD_FILE]
                              [--dump-dir DUMP_DIR]
                              [--modeller-executable MODELLER_EXECUTABLE]
                              [--skip-genes-if-already-present]

Add or remove genes from an already existing structure database. All settings
used to generate your database will be used in this program.

optional arguments:
  -h, --help            show this help message and exit
  -c CONTIGS_DB, --contigs-db CONTIGS_DB
                        Anvi'o contigs database generated by 'anvi-gen-
                        contigs'
  -s STRUCTURE_DB, --structure-db STRUCTURE_DB
                        Anvi'o structure database.
  --genes-to-remove GENES_TO_REMOVE, -r GENES_TO_REMOVE
                        Gene caller ids to remove from your structure
                        database. Multiple of them can be declared by
                        separating with comma (e.g. --genes-to-remove
                        2,4,5,6).
  --genes-to-remove-file GENES_TO_REMOVE_FILE, -R GENES_TO_REMOVE_FILE
                        A file of gene caller ids to remove from your
                        structure database. Each line in the file should be a
                        gene caller id.
  --genes-to-add GENES_TO_ADD, -a GENES_TO_ADD
                        Gene caller ids to remove from your structure
                        database. Multiple of them can be declared by
                        separating with comma (e.g. --genes-to-add 2,4,5,6).
  --genes-to-add-file GENES_TO_ADD_FILE, -A GENES_TO_ADD_FILE
                        A file of gene caller ids to remove from your
                        structure database. Each line in the file should be a
                        gene caller id.
  --dump-dir DUMP_DIR   Modelling and annotating structures requires a lot of
                        moving parts, each which have their own outputs. The
                        output of this program is a structure database
                        containing the pertinent results of this computation,
                        however a lot of stuff doesn't make the cut. By
                        providing a directory for this parameter you will get,
                        in addition to the structure database, a directory
                        containing the raw output for everything.
  --modeller-executable MODELLER_EXECUTABLE
                        The MODELLER program to use. For example, `mod9.19`.
                        The default is `mod9.19`
  --skip-genes-if-already-present
                        If you try to add a gene that is already present,
                        instead of complaining it will be skipped.

DATABASES:
  Declaring relevant anvi'o databases. First things first.

GENES:
  Specifying which genes you want to be modelled.

OUTPUT:
  Output file and output style.

MODELLER EXECUTABLE:
  Which executable program to use for MODELLER, e.g. mod9.19

MISCALLANEOUS:
  Other stuff

    ]]></help>
    <citations>
        <citation type="doi">10.7717/peerj.1319</citation>
        <citation type="bibtex">@ARTICLE{Blankenberg19-anvio,
   author = {Daniel Blankenberg, et al},
   title = {In preparation..},
   }</citation>
    </citations>
</tool>