<tool id="anvi_compute_completeness" name="anvi-compute-completeness" version="5.2">
    <description>A script to generate completeness info for a given list of _splits_</description>
    <requirements>
        <requirement type="package" version="5.2">anvio</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <version_command>anvi-compute-completeness --version</version_command>
    <command><![CDATA[
        cp -R '${input_contigs_db.extra_files_path}' '${output_contigs_db.extra_files_path}'
 &&
 anvi-compute-completeness

#if $splits_of_interest:
    --splits-of-interest '${splits_of_interest}'
#end if

--contigs-db '${output_contigs_db.extra_files_path}/CONTIGS.db'


#if $str( $min_e_value ):
    --min-e-value '${min_e_value}'
#end if

${list_completeness_sources}


#if $str( $completeness_source ):
    --completeness-source '${completeness_source}'
#end if

&> '${GALAXY_ANVIO_LOG}'

    ]]></command>
    <inputs>
        <param name="splits_of_interest" type="data" label="Splits Of Interest" format="txt" optional="True" multiple="False" argument="--splits-of-interest" help="A file with split names. There should be only one column in the file, and each line should correspond to a unique split name."/>
        <param name="input_contigs_db" type="data" label="Contigs Db" format="anvio_contigs_db" optional="False" multiple="False" argument="--contigs-db" help="Anvi'o contigs database generated by 'anvi-gen-contigs'"/>
        <param name="min_e_value" type="float" label="Min E Value" value="1e-15" optional="True" argument="--min-e-value" help="Minimum significance score of an HMM find to be considered as a valid hit. Default is %(default)g."/>
        <param name="list_completeness_sources" type="boolean" label="List Completeness Sources" truevalue="--list-completeness-sources" falsevalue="" checked="False" optional="True" argument="--list-completeness-sources" help="Show available sources and exit."/>
        <param name="completeness_source" type="text" label="Completeness Source" value="" optional="True" argument="--completeness-source" help="Single-copy gene source to use to estimate completeness."/>
    </inputs>
    <outputs>
        <data name="output_contigs_db" format="anvio_contigs_db" format_source="input_contigs_db" metadata_source="input_contigs_db" label="${tool.name} on ${on_string}: Contigs Db"/>
        <data name="GALAXY_ANVIO_LOG" format="txt" label="${tool.name} on ${on_string}: Log"/>
    </outputs>
    <help><![CDATA[
        usage: anvi-compute-completeness [-h] [--splits-of-interest FILE] -c CONTIGS_DB
                              [-e E-VALUE] [--list-completeness-sources]
                              [--completeness-source NAME]

A script to generate completeness info for a given list of _splits_

optional arguments:
  -h, --help            show this help message and exit
  --splits-of-interest FILE
                        A file with split names. There should be only one
                        column in the file, and each line should correspond to
                        a unique split name.
  -c CONTIGS_DB, --contigs-db CONTIGS_DB
                        Anvi'o contigs database generated by 'anvi-gen-
                        contigs'
  -e E-VALUE, --min-e-value E-VALUE
                        Minimum significance score of an HMM find to be
                        considered as a valid hit. Default is 1e-15.
  --list-completeness-sources
                        Show available sources and exit.
  --completeness-source NAME
                        Single-copy gene source to use to estimate
                        completeness.

    ]]></help>
    <citations>
        <citation type="doi">10.7717/peerj.1319</citation>
        <citation type="bibtex">@ARTICLE{Blankenberg19-anvio,
   author = {Daniel Blankenberg, et al},
   title = {In preparation..},
   }</citation>
    </citations>
</tool>