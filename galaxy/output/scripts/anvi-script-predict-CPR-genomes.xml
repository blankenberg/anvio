<tool id="anvi_script_predict_CPR_genomes" name="anvi-script-predict-CPR-genomes" version="5.3.0">
    <description>Screen for genomes to find likely members of CPR</description>
    <requirements>
        <requirement type="package" version="5.3.0">anvio</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <version_command>anvi-script-predict-CPR-genomes --version</version_command>
    <command><![CDATA[
        cp -R '${input_contigs_db.extra_files_path}' '${output_contigs_db.extra_files_path}'
 && 

    #if $input_profile_db:
        cp -R '${input_profile_db.extra_files_path}' '${output_profile_db.extra_files_path}'
    #else
        echo ''
    #end if
 &&
 anvi-script-predict-CPR-genomes

#if $classifier_object:
     '${classifier_object}'
#end if

--contigs-db '${output_contigs_db.extra_files_path}/CONTIGS.db'

--profile-db '${output_profile_db.extra_files_path}/PROFILE.db'


#if $str( $collection_name ):
    --collection-name '${collection_name}'
#end if

${list_collections}

${report_only_cpr}


#if $str( $min_genome_size ):
    --min-genome-size '${min_genome_size}'
#end if


#if $str( $min_percent_completion ):
    --min-percent-completion '${min_percent_completion}'
#end if


#if $str( $max_percent_redundancy ):
    --max-percent-redundancy '${max_percent_redundancy}'
#end if


#if $str( $min_class_probability ):
    --min-class-probability '${min_class_probability}'
#end if


#if $output_file:
    --output-file '${output_file}'
#end if

--just-do-it
&> '${GALAXY_ANVIO_LOG}'

    ]]></command>
    <inputs>
        <param name="classifier_object" type="data" label="Classifier Object" format="anvio_classifier" optional="True" multiple="False" argument="" help="Model output generated by anvi-script-gen-CPR-classifier"/>
        <param name="input_contigs_db" type="data" label="Contigs Db" format="anvio_contigs_db" optional="False" multiple="False" argument="--contigs-db" help="Anvi'o contigs database generated by 'anvi-gen-contigs'"/>
        <param name="input_profile_db" type="data" label="Profile Db" format="anvio_profile_db" optional="True" multiple="False" argument="--profile-db" help="Anvi'o profile database"/>
        <param name="collection_name" type="text" label="Collection Name" value="" optional="True" argument="--collection-name" help="Collection name."/>
        <param name="list_collections" type="boolean" label="List Collections" truevalue="--list-collections" falsevalue="" checked="False" optional="True" argument="--list-collections" help="Show available collections and exit."/>
        <param name="report_only_cpr" type="boolean" label="Report Only Cpr" truevalue="--report-only-cpr" falsevalue="" checked="False" optional="True" argument="--report-only-cpr" help="Include only bins that look like CPR genomes."/>
        <param name="min_genome_size" type="text" label="Min Genome Size" value="0.5" optional="True" argument="--min-genome-size" help="Minimum genome size to consider for CPR in Mbp. Default is %(default)f"/>
        <param name="min_percent_completion" type="text" label="Min Percent Completion" value="50" optional="True" argument="--min-percent-completion" help="Minimum percent completion estimate based on anvi'o default single-copy gene collections. Default is %(default)d"/>
        <param name="max_percent_redundancy" type="text" label="Max Percent Redundancy" value="30" optional="True" argument="--max-percent-redundancy" help="Maxumum percent redundancy or single-copy genes in an anvi'o bin, or a genome to consider for classification. The default is %(default)d"/>
        <param name="min_class_probability" type="text" label="Min Class Probability" value="75" optional="True" argument="--min-class-probability" help="If the classification confidence is below this don't bother. Default is %(default)d."/>
    </inputs>
    <outputs>
        <data name="output_contigs_db" format="anvio_contigs_db" format_source="input_contigs_db" metadata_source="input_contigs_db" label="${tool.name} on ${on_string}: Contigs Db"/>
        <data name="output_profile_db" format="anvio_profile_db" format_source="input_profile_db" metadata_source="input_profile_db" label="${tool.name} on ${on_string}: Profile Db"/>
        <data name="output_file" format="txt" format_source="input_output_file" metadata_source="input_output_file" label="${tool.name} on ${on_string}: Output File"/>
        <data name="GALAXY_ANVIO_LOG" format="txt" label="${tool.name} on ${on_string}: Log"/>
    </outputs>
    <help><![CDATA[
        usage: anvi-script-predict-CPR-genomes [-h] -c CONTIGS_DB [-p PROFILE_DB]
                              [-C COLLECTION_NAME] [--list-collections]
                              [--report-only-cpr]
                              [--min-genome-size MIN_GENOME_SIZE]
                              [--min-percent-completion MIN_PERCENT_COMPLETION]
                              [--max-percent-redundancy MAX_PERCENT_REDUNDANCY]
                              [--min-class-probability MIN_CLASS_PROBABILITY]
                              [-o FILE_PATH] [--just-do-it]
                              CLASSIFIER_FILE

Screen for genomes to find likely members of CPR

positional arguments:
  CLASSIFIER_FILE       Model output generated by anvi-script-gen-CPR-
                        classifier

optional arguments:
  -h, --help            show this help message and exit
  -c CONTIGS_DB, --contigs-db CONTIGS_DB
                        Anvi'o contigs database generated by 'anvi-gen-
                        contigs'
  -p PROFILE_DB, --profile-db PROFILE_DB
                        Anvi'o profile database
  -C COLLECTION_NAME, --collection-name COLLECTION_NAME
                        Collection name.
  --list-collections    Show available collections and exit.
  --report-only-cpr     Include only bins that look like CPR genomes.
  --min-genome-size MIN_GENOME_SIZE
                        Minimum genome size to consider for CPR in Mbp.
                        Default is 0.500000
  --min-percent-completion MIN_PERCENT_COMPLETION
                        Minimum percent completion estimate based on anvi'o
                        default single-copy gene collections. Default is 50
  --max-percent-redundancy MAX_PERCENT_REDUNDANCY
                        Maxumum percent redundancy or single-copy genes in an
                        anvi'o bin, or a genome to consider for
                        classification. The default is 30
  --min-class-probability MIN_CLASS_PROBABILITY
                        If the classification confidence is below this don't
                        bother. Default is 75.
  -o FILE_PATH, --output-file FILE_PATH
                        File path to store results.
  --just-do-it          Don't bother me with questions or warnings, just do
                        it.

    ]]></help>
    <citations>
        <citation type="doi">10.7717/peerj.1319</citation>
        <citation type="bibtex">@ARTICLE{Blankenberg19-anvio,
   author = {Daniel Blankenberg, et al},
   title = {In preparation..},
   }</citation>
    </citations>
</tool>