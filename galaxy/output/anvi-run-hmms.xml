<tool id="anvi_run_hmms" name="anvi-run-hmms" version="5.3">
    <description>This program deals with populating tables that store HMM hits in an                                                  anvi'o contigs database.</description>
    <requirements>
        <requirement type="package" version="5.3">anvio</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <version_command>anvi-run-hmms --version</version_command>
    <command><![CDATA[
        cp -R '${input_contigs_db.extra_files_path}' '${output_contigs_db.extra_files_path}'
 &&
 anvi-run-hmms
--contigs-db '${output_contigs_db.extra_files_path}/CONTIGS.db'


#if $hmm_profile_dir:
    --hmm-profile-dir '${hmm_profile_dir.extra_files_path}'
#end if


#if $str( $installed_hmm_profile ):
    --installed-hmm-profile '${installed_hmm_profile}'
#end if

--num-threads "\${GALAXY_SLOTS:-1}"

&> '${GALAXY_ANVIO_LOG}'

    ]]></command>
    <inputs>
        <param name="input_contigs_db" type="data" label="Contigs Db" format="anvio_contigs_db" optional="False" multiple="False" argument="--contigs-db" help="Anvi'o contigs database generated by 'anvi-gen-contigs'"/>
        <param name="hmm_profile_dir" type="data" label="Hmm Profile Dir" format="anvio_hmm_profile" optional="True" multiple="False" argument="--hmm-profile-dir" help="You can use this parameter you can specify a directory path that contain an HMM profile. This way you can run HMM profiles that are not included in anvi'o. See the online to find out about the specifics of this directory structure ."/>
        <param name="installed_hmm_profile" type="text" label="Installed Hmm Profile" value="" optional="True" argument="--installed-hmm-profile" help='When you run this program without any parameter, it runs all 4 HMM profiles installed on your system. If you want only a specific one to run, you can select it by using this parameter. These are the currently available ones: "Rinke_et_al" (type: singlecopy), "Campbell_et_al" (type: singlecopy), "BUSCO_83_Protista" (type: singlecopy), "Ribosomal_RNAs" (type: Ribosomal_RNAs).'/>
    </inputs>
    <outputs>
        <data name="output_contigs_db" format="anvio_contigs_db" format_source="input_contigs_db" metadata_source="input_contigs_db" label="${tool.name} on ${on_string}: Contigs Db"/>
        <data name="GALAXY_ANVIO_LOG" format="txt" label="${tool.name} on ${on_string}: Log"/>
    </outputs>
    <help><![CDATA[
        usage: anvi-run-hmms [-h] -c CONTIGS_DB [-H HMM PROFILE PATH]
                              [-I HMM PROFILE NAME] [-T NUM_THREADS]

This program deals with populating tables that store HMM hits in an anvi'o
contigs database.

optional arguments:
  -h, --help            show this help message and exit
  -c CONTIGS_DB, --contigs-db CONTIGS_DB
                        Anvi'o contigs database generated by 'anvi-gen-
                        contigs'
  -H HMM PROFILE PATH, --hmm-profile-dir HMM PROFILE PATH
                        You can use this parameter you can specify a directory
                        path that contain an HMM profile. This way you can run
                        HMM profiles that are not included in anvi'o. See the
                        online to find out about the specifics of this
                        directory structure .
  -I HMM PROFILE NAME, --installed-hmm-profile HMM PROFILE NAME
                        When you run this program without any parameter, it
                        runs all 4 HMM profiles installed on your system. If
                        you want only a specific one to run, you can select it
                        by using this parameter. These are the currently
                        available ones: "Rinke_et_al" (type: singlecopy),
                        "Campbell_et_al" (type: singlecopy),
                        "BUSCO_83_Protista" (type: singlecopy),
                        "Ribosomal_RNAs" (type: Ribosomal_RNAs).
  -T NUM_THREADS, --num-threads NUM_THREADS
                        Maximum number of threads to use for multithreading
                        whenever possible. Very conservatively, the default is
                        1. It is a good idea to not exceed the number of CPUs
                        / cores on your system. Plus, please be careful with
                        this option if you are running your commands on a SGE
                        --if you are clusterizing your runs, and asking for
                        multiple threads to use, you may deplete your
                        resources very fast.

    ]]></help>
    <citations>
        <citation type="doi">10.7717/peerj.1319</citation>
        <citation type="bibtex">@ARTICLE{Blankenberg19-anvio,
   author = {Daniel Blankenberg, et al},
   title = {In preparation..},
   }</citation>
    </citations>
</tool>