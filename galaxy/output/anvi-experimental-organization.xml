<tool id="anvi_experimental_organization" name="anvi-experimental-organization" version="5.3.0">
    <description>why yes we do stuff here.</description>
    <requirements>
        <requirement type="package" version="5.3.0">anvio</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <version_command>anvi-experimental-organization --version</version_command>
    <command><![CDATA[
        
    #if $input_profile_db:
        cp -R '${input_profile_db.extra_files_path}' '${output_profile_db.extra_files_path}'
    #else
        echo ''
    #end if
 && 
cp -R '${input_contigs_db.extra_files_path}' '${output_contigs_db.extra_files_path}'
 &&
 anvi-experimental-organization

#if $config_file:
     '${config_file}'
#end if

--profile-db '${output_profile_db.extra_files_path}/PROFILE.db'

--contigs-db '${output_contigs_db.extra_files_path}/CONTIGS.db'


#if $input_directory:
    --input-directory '${input_directory.extra_files_path}'
#end if


#if $str( $name ):
    --name '${name}'
#end if


#if $str( $distance ):
    --distance '${distance}'
#end if


#if $str( $linkage ):
    --linkage '${linkage}'
#end if

${skip_store_in_db}


#if $output_file:
    --output-file '${output_file}'
#end if

${dry_run}

&> '${GALAXY_ANVIO_LOG}'

    ]]></command>
    <inputs>
        <param name="config_file" type="data" label="Config File" format="txt" optional="True" multiple="False" argument="" help="Config file for clustering of contigs. See documentation for help."/>
        <param name="input_profile_db" type="data" label="Profile Db" format="anvio_profile_db" optional="True" multiple="False" argument="--profile-db" help="Anvi'o profile database"/>
        <param name="input_contigs_db" type="data" label="Contigs Db" format="anvio_contigs_db" optional="False" multiple="False" argument="--contigs-db" help="Anvi'o contigs database generated by 'anvi-gen-contigs'"/>
        <param name="input_directory" type="data" label="Input Directory" format="anvio_profile_db" optional="True" multiple="False" argument="--input-directory" help="Input directory where the input files addressed from the configuration file can be found (i.e., the profile database, if PROFILE.db::TABLE notation is used in the configuration file)."/>
        <param name="name" type="text" label="Name" value="" optional="True" argument="--name" help="The name to use when storing the resulting clustering in the database. This name will appear in the interactive interface and other relevant interfaces. Please consider using a short and descriptive single-word (if you do not do that you will make anvi'o complain)."/>
        <param name="distance" type="text" label="Distance" value="" optional="True" argument="--distance" help='The distance metric for the hierarchical clustering. If you do not use this flag, the distance metric you defined in your clustering config file will be used. If you have not defined one in your config file, then the system default will be used, which is "euclidean".'/>
        <param name="linkage" type="text" label="Linkage" value="" optional="True" argument="--linkage" help="Same story with the `--distance`, except, the system default for this one is ward."/>
        <param name="skip_store_in_db" type="boolean" label="Skip Store In Db" truevalue="--skip-store-in-db" falsevalue="" checked="False" optional="True" argument="--skip-store-in-db" help="By default, analysis results are stored in the profile database. The use of this flag will let you skip that"/>
        <param name="dry_run" type="boolean" label="Dry Run" truevalue="--dry-run" falsevalue="" checked="False" optional="True" argument="--dry-run" help="Don't do anything real. Test everything, and stop right before wherever the developer said 'well, this is enough testing', and decided to print out results."/>
    </inputs>
    <outputs>
        <data name="output_profile_db" format="anvio_profile_db" format_source="input_profile_db" metadata_source="input_profile_db" label="${tool.name} on ${on_string}: Profile Db"/>
        <data name="output_contigs_db" format="anvio_contigs_db" format_source="input_contigs_db" metadata_source="input_contigs_db" label="${tool.name} on ${on_string}: Contigs Db"/>
        <data name="output_file" format="txt" format_source="input_output_file" metadata_source="input_output_file" label="${tool.name} on ${on_string}: Output File"/>
        <data name="GALAXY_ANVIO_LOG" format="txt" label="${tool.name} on ${on_string}: Log"/>
    </outputs>
    <help><![CDATA[
        usage: anvi-experimental-organization [-h] [-p PROFILE_DB] -c CONTIGS_DB [-i DIR_PATH]
                              [-N NAME] [--distance DISTANCE_METRIC]
                              [--linkage LINKAGE_METHOD] [--skip-store-in-db]
                              [-o FILE_PATH] [--dry-run]
                              FILE

why yes we do stuff here.

positional arguments:
  FILE                  Config file for clustering of contigs. See
                        documentation for help.

optional arguments:
  -h, --help            show this help message and exit
  -p PROFILE_DB, --profile-db PROFILE_DB
                        Anvi'o profile database
  -c CONTIGS_DB, --contigs-db CONTIGS_DB
                        Anvi'o contigs database generated by 'anvi-gen-
                        contigs'
  -i DIR_PATH, --input-directory DIR_PATH
                        Input directory where the input files addressed from
                        the configuration file can be found (i.e., the profile
                        database, if PROFILE.db::TABLE notation is used in the
                        configuration file).
  -N NAME, --name NAME  The name to use when storing the resulting clustering
                        in the database. This name will appear in the
                        interactive interface and other relevant interfaces.
                        Please consider using a short and descriptive single-
                        word (if you do not do that you will make anvi'o
                        complain).
  --distance DISTANCE_METRIC
                        The distance metric for the hierarchical clustering.
                        If you do not use this flag, the distance metric you
                        defined in your clustering config file will be used.
                        If you have not defined one in your config file, then
                        the system default will be used, which is "euclidean".
  --linkage LINKAGE_METHOD
                        Same story with the `--distance`, except, the system
                        default for this one is ward.
  --skip-store-in-db    By default, analysis results are stored in the profile
                        database. The use of this flag will let you skip that
  -o FILE_PATH, --output-file FILE_PATH
                        File path to store results.
  --dry-run             Don't do anything real. Test everything, and stop
                        right before wherever the developer said 'well, this
                        is enough testing', and decided to print out results.

    ]]></help>
    <citations>
        <citation type="doi">10.7717/peerj.1319</citation>
        <citation type="bibtex">@ARTICLE{Blankenberg19-anvio,
   author = {Daniel Blankenberg, et al},
   title = {In preparation..},
   }</citation>
    </citations>
</tool>