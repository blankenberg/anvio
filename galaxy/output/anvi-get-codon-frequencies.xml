<tool id="anvi_get_codon_frequencies" name="anvi-get-codon-frequencies" version="5.2">
    <description>Frequencies of AA linkmers</description>
    <requirements>
        <requirement type="package" version="5.2">anvio</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <version_command>anvi-get-codon-frequencies --version</version_command>
    <command><![CDATA[
        ln -s '${input_file}' 'input_file.bam' && ln -s '${input_file.metadata.bam_index}' 'input_file.bam.bai'
 && 
cp -R '${input_contigs_db.extra_files_path}' '${output_contigs_db.extra_files_path}'
 &&
 anvi-get-codon-frequencies
--input-file 'input_file.bam'

--contigs-db '${output_contigs_db.extra_files_path}/CONTIGS.db'

--gene-caller-id '${gene_caller_id}'

${return_AA_frequencies_instead}

--output-file '${output_file}'

&> '${GALAXY_ANVIO_LOG}'

    ]]></command>
    <inputs>
        <param name="input_file" type="data" label="Input File" format="bam" optional="False" multiple="False" argument="--input-file" help="Sorted and indexed BAM file to analyze."/>
        <param name="input_contigs_db" type="data" label="Contigs Db" format="anvio_contigs_db" optional="False" multiple="False" argument="--contigs-db" help="Anvi'o contigs database generated by 'anvi-gen-contigs'"/>
        <param name="gene_caller_id" type="integer" label="Gene Caller Id" value="" optional="False" argument="--gene-caller-id" help="A single gene id."/>
        <param name="return_AA_frequencies_instead" type="boolean" label="Return Aa Frequencies Instead" truevalue="--return-AA-frequencies-instead" falsevalue="" checked="False" optional="True" argument="--return-AA-frequencies-instead" help="By default, anvi'o will return codon frequencies (as the name suggests), but you can ask for amino acid frequencies instead, simply because you always need more data and more stuff. You're lucky this time, but is there an end to this? Will you ever be satisfied with what you have? Anvi'o needs answers."/>
    </inputs>
    <outputs>
        <data name="output_contigs_db" format="anvio_contigs_db" format_source="input_contigs_db" metadata_source="input_contigs_db" label="${tool.name} on ${on_string}: Contigs Db"/>
        <data name="output_file" format="txt" format_source="input_output_file" metadata_source="input_output_file" label="${tool.name} on ${on_string}: Output File"/>
        <data name="GALAXY_ANVIO_LOG" format="txt" label="${tool.name} on ${on_string}: Log"/>
    </outputs>
    <help><![CDATA[
        usage: anvi-get-codon-frequencies [-h] -i INPUT_BAM -c CONTIGS_DB --gene-caller-id
                              GENE_CALLER_ID [--return-AA-frequencies-instead]
                              -o FILE_PATH

Frequencies of AA linkmers

optional arguments:
  -h, --help            show this help message and exit
  -i INPUT_BAM, --input-file INPUT_BAM
                        Sorted and indexed BAM file to analyze.
  -c CONTIGS_DB, --contigs-db CONTIGS_DB
                        Anvi'o contigs database generated by 'anvi-gen-
                        contigs'
  --gene-caller-id GENE_CALLER_ID
                        A single gene id.
  --return-AA-frequencies-instead
                        By default, anvi'o will return codon frequencies (as
                        the name suggests), but you can ask for amino acid
                        frequencies instead, simply because you always need
                        more data and more stuff. You're lucky this time, but
                        is there an end to this? Will you ever be satisfied
                        with what you have? Anvi'o needs answers.
  -o FILE_PATH, --output-file FILE_PATH
                        File path to store results.

    ]]></help>
    <citations>
        <citation type="doi">10.7717/peerj.1319</citation>
        <citation type="bibtex">@ARTICLE{Blankenberg19-anvio,
   author = {Daniel Blankenberg, et al},
   title = {In preparation..},
   }</citation>
    </citations>
</tool>