<tool id="anvi_cluster_with_concoct" name="anvi-cluster-with-concoct" version="5.3">
    <description>A program to cluster items in a merged anvi'o profile using CONCOCT, and optionally                                                  creating a collection in the profile database. This is especially useful if you need to                                                  have more control over the number of clusters to work with if you are planning to refine                                                  them manually later.</description>
    <requirements>
        <requirement type="package" version="5.3">anvio</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <version_command>anvi-cluster-with-concoct --version</version_command>
    <command><![CDATA[
        cp -R '${input_profile_db.extra_files_path}' '${output_profile_db.extra_files_path}'
 && 
cp -R '${input_contigs_db.extra_files_path}' '${output_contigs_db.extra_files_path}'
 &&
 anvi-cluster-with-concoct
--profile-db '${output_profile_db.extra_files_path}/PROFILE.db'

--contigs-db '${output_contigs_db.extra_files_path}/CONTIGS.db'


#if $output_file:
    --output-file '${output_file}'
#end if

${skip_store_in_db}


#if $str( $collection_name ):
    --collection-name '${collection_name}'
#end if


#if $str( $num_clusters_requested ):
    --num-clusters-requested '${num_clusters_requested}'
#end if

&> '${GALAXY_ANVIO_LOG}'

    ]]></command>
    <inputs>
        <param name="input_profile_db" type="data" label="Profile Db" format="anvio_profile_db" optional="False" multiple="False" argument="--profile-db" help="Anvi'o profile database"/>
        <param name="input_contigs_db" type="data" label="Contigs Db" format="anvio_contigs_db" optional="False" multiple="False" argument="--contigs-db" help="Anvi'o contigs database generated by 'anvi-gen-contigs'"/>
        <param name="skip_store_in_db" type="boolean" label="Skip Store In Db" truevalue="--skip-store-in-db" falsevalue="" checked="False" optional="True" argument="--skip-store-in-db" help="By default, analysis results are stored in the profile database. The use of this flag will let you skip that"/>
        <param name="collection_name" type="text" label="Collection Name" value="CONCOCT" optional="True" argument="--collection-name" help="Collection name."/>
        <param name="num_clusters_requested" type="integer" label="Num Clusters Requested" value="400" optional="True" argument="--num-clusters-requested" help="How many clusters do you request? Default is %(default)d."/>
    </inputs>
    <outputs>
        <data name="output_profile_db" format="anvio_profile_db" format_source="input_profile_db" metadata_source="input_profile_db" label="${tool.name} on ${on_string}: Profile Db"/>
        <data name="output_contigs_db" format="anvio_contigs_db" format_source="input_contigs_db" metadata_source="input_contigs_db" label="${tool.name} on ${on_string}: Contigs Db"/>
        <data name="output_file" format="txt" format_source="input_output_file" metadata_source="input_output_file" label="${tool.name} on ${on_string}: Output File"/>
        <data name="GALAXY_ANVIO_LOG" format="txt" label="${tool.name} on ${on_string}: Log"/>
    </outputs>
    <help><![CDATA[
        usage: anvi-cluster-with-concoct [-h] -p PROFILE_DB -c CONTIGS_DB [-o FILE_PATH]
                              [--skip-store-in-db] [-C COLLECTION_NAME]
                              [--num-clusters-requested INT]

A program to cluster items in a merged anvi'o profile using CONCOCT, and
optionally creating a collection in the profile database. This is especially
useful if you need to have more control over the number of clusters to work
with if you are planning to refine them manually later.

optional arguments:
  -h, --help            show this help message and exit
  -p PROFILE_DB, --profile-db PROFILE_DB
                        Anvi'o profile database
  -c CONTIGS_DB, --contigs-db CONTIGS_DB
                        Anvi'o contigs database generated by 'anvi-gen-
                        contigs'
  -o FILE_PATH, --output-file FILE_PATH
                        File path to store results.
  --skip-store-in-db    By default, analysis results are stored in the profile
                        database. The use of this flag will let you skip that
  -C COLLECTION_NAME, --collection-name COLLECTION_NAME
                        Collection name.
  --num-clusters-requested INT
                        How many clusters do you request? Default is 400.

    ]]></help>
    <citations>
        <citation type="doi">10.7717/peerj.1319</citation>
        <citation type="bibtex">@ARTICLE{Blankenberg19-anvio,
   author = {Daniel Blankenberg, et al},
   title = {In preparation..},
   }</citation>
    </citations>
</tool>