<tool id="anvi_import_functions" name="anvi-import-functions" version="5.3">
    <description>Parse and store functional annotation of genes.</description>
    <requirements>
        <requirement type="package" version="5.3">anvio</requirement>
    </requirements>
    <stdio>
        <exit_code range="1:" />
    </stdio>
    <version_command>anvi-import-functions --version</version_command>
    <command><![CDATA[
        cp -R '${input_contigs_db.extra_files_path}' '${output_contigs_db.extra_files_path}'
 &&
 anvi-import-functions
--contigs-db '${output_contigs_db.extra_files_path}/CONTIGS.db'


#if $str( $parser ):
    --parser '${parser}'
#end if

--input-files '${input_files}'

${drop_previous_annotations}

&> '${GALAXY_ANVIO_LOG}'

    ]]></command>
    <inputs>
        <param name="input_contigs_db" type="data" label="Contigs Db" format="anvio_contigs_db" optional="False" multiple="False" argument="--contigs-db" help="Anvi'o contigs database generated by 'anvi-gen-contigs'"/>
        <param name="parser" type="text" label="Parser" value="" optional="True" argument="--parser" help="Parser to make sense of the input files (if you need one). There are currently 1 parsers readily available: ['interproscan']. IT IS OK if you do not select a parser if you have a standard, TAB-delimited input file for funcitonal annotation of genes. If this is not like 2018 and everything is already outdated, you should be able to go to this address and learn everything you need like a boss: http://merenlab.org/2016/06/18/importing-functions/"/>
        <param name="input_files" type="data" label="Input Files" format="data" optional="False" multiple="True" argument="--input-files" help="One or more input files should follow this parameter. The way these files will be handled will depend on which parser you selected (if you did select any)."/>
        <param name="drop_previous_annotations" type="boolean" label="Drop Previous Annotations" truevalue="--drop-previous-annotations" falsevalue="" checked="False" optional="True" argument="--drop-previous-annotations" help="Use this flag if you want anvi'o to remove ALL previous functional annotations for your genes, and then import the new data. The default behavior will add any annotation source into the db incrementally unless there are already annotations from this source. In which case, it will first remove previous annotations for that source only (i.e., if source X is both in the db and in the incoming annotations data, it will replace the content of source X in the db)."/>
    </inputs>
    <outputs>
        <data name="output_contigs_db" format="anvio_contigs_db" format_source="input_contigs_db" metadata_source="input_contigs_db" label="${tool.name} on ${on_string}: Contigs Db"/>
        <data name="GALAXY_ANVIO_LOG" format="txt" label="${tool.name} on ${on_string}: Log"/>
    </outputs>
    <help><![CDATA[
        usage: anvi-import-functions [-h] -c CONTIGS_DB [-p PARSER] -i FILES)
                              [FILE(S ...] [--drop-previous-annotations]

Parse and store functional annotation of genes.

optional arguments:
  -h, --help            show this help message and exit
  -c CONTIGS_DB, --contigs-db CONTIGS_DB
                        Anvi'o contigs database generated by 'anvi-gen-
                        contigs'
  -p PARSER, --parser PARSER
                        Parser to make sense of the input files (if you need
                        one). There are currently 1 parsers readily available:
                        ['interproscan']. IT IS OK if you do not select a
                        parser if you have a standard, TAB-delimited input
                        file for funcitonal annotation of genes. If this is
                        not like 2018 and everything is already outdated, you
                        should be able to go to this address and learn
                        everything you need like a boss:
                        http://merenlab.org/2016/06/18/importing-functions/
  -i FILE(S) [FILE(S) ...], --input-files FILE(S) [FILE(S) ...]
                        One or more input files should follow this parameter.
                        The way these files will be handled will depend on
                        which parser you selected (if you did select any).
  --drop-previous-annotations
                        Use this flag if you want anvi'o to remove ALL
                        previous functional annotations for your genes, and
                        then import the new data. The default behavior will
                        add any annotation source into the db incrementally
                        unless there are already annotations from this source.
                        In which case, it will first remove previous
                        annotations for that source only (i.e., if source X is
                        both in the db and in the incoming annotations data,
                        it will replace the content of source X in the db).

    ]]></help>
    <citations>
        <citation type="doi">10.7717/peerj.1319</citation>
        <citation type="bibtex">@ARTICLE{Blankenberg19-anvio,
   author = {Daniel Blankenberg, et al},
   title = {In preparation..},
   }</citation>
    </citations>
</tool>